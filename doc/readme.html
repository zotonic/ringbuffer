<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.35.1">
    <meta name="project" content="ringbuffer v1.2.0+build.18.refca920a0">


    <title>Overview — ringbuffer v1.2.0+build.18.refca920a0</title>
    <link rel="stylesheet" href="dist/html-erlang-4IXSOGMD.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-C002F7F1.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-PVRIOB7F.js"></script>

  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
ringbuffer
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.2.0+build.18.refca920a0
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ringbuffer</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/zotonic/ringbuffer/blob/v1.2.0+build.18.refca920a0/README.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>


    <span>Overview</span>
  </h1>

<p><a href="https://github.com/zotonic/ringbuffer/actions?query=workflow%3ATest"><img src="https://github.com/zotonic/ringbuffer/workflows/Test/badge.svg" alt="Test"/></a>
<a href="https://hex.pm/packages/ringbuffer"><img src="https://img.shields.io/hexpm/v/ringbuffer.svg" alt="Hex version" title="Hex version"/></a></p><h1>Ringbuffer</h1><p>A ring buffer implementation using Erlang and ets tables.</p><p>Main feature is lock free writing without message passing, making
this implementation ideal for log systems with many fast writers or
big bursts.</p><p>Ringbuffer implements a length limited queue. In systems this is
often implemented as a ring, or cylic, buffer. Where the writer can
push the reader ahead if the buffer is full.</p><p>This kind of buffers is useful in situations where you can have
surges of writers, with a limited amount of readers. And where it
is allowed to drop entries from the queue if the readers can't keep
up with the writers.</p><p>An example is a logging system for a http server, which can handle large
bursts of requests. The logger is often limited in its throughput, and it
is perfectly ok to drop log entries if that means that the server can
handle the peak load.</p><p>This ring buffer is technically not a ring. It is a size limited buffer,
implemented in ets. Its main characteristics are:</p><ul><li>Optimized for writes: non locking and non blocking queue writes;</li><li>Size limited, define the maximum number of entries upon queue creation;</li><li>Readers are synchronized to prevent race conditions;</li><li>Readers return the number of entries that were lost due to too fast writers;</li><li>As many queues as needed.</li></ul><p>The size of the ring is set upon creation. If the ring is full
then older entries are overwritten. Overwritten entries are skipped
when reading the next entry. The number of skipped entries is
returned.</p><p>The ring's ets table is owned by a process managed by the ringbuffer_sup.</p><h2 id="installation" class="section-heading">
  <a href="#installation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Installation</span>
</h2>
<p>RingBuffer is at Hex, in your <code class="inline">rebar.config</code> file use:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="6556736129-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6556736129-2">[</span><span class="w">
    </span><span class="ss">ringbuffer</span><span class="w">
</span><span class="p" data-group-id="6556736129-2">]</span><span class="p" data-group-id="6556736129-1">}</span><span class="p">.</span></code></pre><p>You can also use the direct Git url and use the development version:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9621524033-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9621524033-2">[</span><span class="w">
    </span><span class="p" data-group-id="9621524033-3">{</span><span class="ss">ringbuffer</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9621524033-4">{</span><span class="ss">git</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;https://github.com/zotonic/ringbuffer.git&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9621524033-5">{</span><span class="ss">branch</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;main&quot;</span><span class="p" data-group-id="9621524033-5">}</span><span class="p" data-group-id="9621524033-4">}</span><span class="p" data-group-id="9621524033-3">}</span><span class="w">
</span><span class="p" data-group-id="9621524033-2">]</span><span class="p" data-group-id="9621524033-1">}</span><span class="p">.</span></code></pre><h2 id="usage" class="section-heading">
  <a href="#usage" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Usage</span>
</h2>
<p>First create a ringbuffer. The buffer is named with an atom
and needs a size of the maximum amount of items to buffer.</p><pre><code class="makeup erlang" translate="no"><span class="w">    </span><span class="p" data-group-id="6649421549-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Pid</span><span class="p" data-group-id="6649421549-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ringbuffer</span><span class="p">:</span><span class="nf">new</span><span class="p" data-group-id="6649421549-2">(</span><span class="ss">name</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p" data-group-id="6649421549-2">)</span></code></pre><p>Then an entry can be written:</p><pre><code class="makeup erlang" translate="no"><span class="w">    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ringbuffer</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="9946423718-1">(</span><span class="ss">name</span><span class="p">,</span><span class="w"> </span><span class="n">Payload</span><span class="p" data-group-id="9946423718-1">)</span><span class="p">.</span></code></pre><p>The <code class="inline">Payload</code> can be any Erlang term.</p><p>It can be read afterwards:</p><pre><code class="makeup erlang" translate="no"><span class="w">    </span><span class="p" data-group-id="7154137764-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7154137764-2">{</span><span class="n">NSkipped</span><span class="p">,</span><span class="w"> </span><span class="n">Payload</span><span class="p" data-group-id="7154137764-2">}</span><span class="p" data-group-id="7154137764-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ringbuffer</span><span class="p">:</span><span class="nf">read</span><span class="p" data-group-id="7154137764-3">(</span><span class="ss">name</span><span class="p" data-group-id="7154137764-3">)</span><span class="p">.</span></code></pre><p>The <code class="inline">NSkipped</code> is the number of entries skipped during reads. If the consumer
can keep up with the producers then it will be <code class="inline">0</code>. If entries are overwritten
then it will return the number of overwritten entries.</p><p>If the buffer is empty then an error is returned:</p><pre><code class="makeup erlang" translate="no"><span class="w">    </span><span class="p" data-group-id="1295564633-1">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">empty</span><span class="p" data-group-id="1295564633-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ringbuffer</span><span class="p">:</span><span class="nf">read</span><span class="p" data-group-id="1295564633-2">(</span><span class="ss">name</span><span class="p" data-group-id="1295564633-2">)</span><span class="p">.</span></code></pre><h2 id="use-in-your-own-supervisor" class="section-heading">
  <a href="#use-in-your-own-supervisor" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Use in your own supervisor</span>
</h2>
<p>You can use ringbuffer in your own supervisor with the following child spec:</p><pre><code class="makeup erlang" translate="no"><span class="w">    </span><span class="c1">% Size and name of the ringbuffer</span><span class="w">
    </span><span class="n">BufferSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="n">NameOfMyBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">foobar</span><span class="p">,</span><span class="w">
    </span><span class="c1">% The child spec for your supervisor</span><span class="w">
    </span><span class="p" data-group-id="8601444744-1">#{</span><span class="w">
        </span><span class="ss">start</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="8601444744-2">{</span><span class="ss">ringbuffer_process</span><span class="p">,</span><span class="w"> </span><span class="ss">start_link</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8601444744-3">[</span><span class="n">NameOfMyBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">BufferSize</span><span class="p" data-group-id="8601444744-3">]</span><span class="p" data-group-id="8601444744-2">}</span><span class="p">,</span><span class="w">
        </span><span class="ss">restart</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">permanent</span><span class="p">,</span><span class="w">
        </span><span class="ss">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">worker</span><span class="w">
    </span><span class="p" data-group-id="8601444744-1">}</span></code></pre><h2 id="test" class="section-heading">
  <a href="#test" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Test</span>
</h2>
<p>Run the tests:</p><pre><code class="makeup erlang" translate="no"><span class="ss">make</span><span class="w"> </span><span class="ss">test</span></code></pre><p>All tests should pass.</p><p>For additional checks, also run:</p><pre><code class="makeup erlang" translate="no"><span class="ss">make</span><span class="w"> </span><span class="ss">xref</span><span class="w">
</span><span class="ss">make</span><span class="w"> </span><span class="ss">dialyzer</span></code></pre><h2 id="license" class="section-heading">
  <a href="#license" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">License</span>
</h2>
<p>Ringbuffer is licensed under the Apache 2.0 license.</p>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="license.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
License
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/ringbuffer/1.2.0+build.18.refca920a0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/ringbuffer/1.2.0+build.18.refca920a0">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/ringbuffer/1.2.0+build.18.refca920a0/show/README.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ringbuffer.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.35.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
